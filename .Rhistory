library(data.table)
raobs <- fread("data/raob_soundings26577.tmp")
library(data.table)
library(rvad)
library(metR)
devtools::install_github("eliocamp/metR")
library(metR)
Glanc
library(data.table)
library(rvad)
library(metR)
GlanceNetCDF("data/cfrad.20181111_105834.0000_to_20181111_110122.0000_RMA4_0200_02.nc")
radial_wind <- ReadNetCDF("data/cfrad.20181111_105834.0000_to_20181111_110122.0000_RMA4_0200_02.nc", vars = c("Vda", "azimuth", "elevation"))
View(radial_wind)
unique(radial_wind$azimuth)
unique(radial_wind$elevation)
GlanceNetCDF("data/cfrad.20181111_105834.0000_to_20181111_110122.0000_RMA4_0200_02.nc")
unique(radial_wind$time)
VAD <- with(radial_wind, vad_fit(Vda, azimuth, range, elevation))
plot(VAD)
wind_profile <- vad_regrid(VAD, layer_width = 100)
plot(wind_profile)
one_elevation <- subset(radial_wind, elevation == unique(elevation)[1] &
!is.na(radial_wind))
one_elevation <- subset(radial_wind, elevation == unique(elevation)[1] &
!is.na(Vda))
ggplot(one_elevation, aes(azimuth, range)) +
geom_point(aes(color = Vda, size = range^2)) +
scale_radius(range = c(0, 0.05), guide = "none") +
scale_color_gradient2(low = "blue", high = "red") +
scale_y_continuous(limits = c(0, 100000)) +
coord_polar()
library(ggplot2)
ggplot(one_elevation, aes(azimuth, range)) +
geom_point(aes(color = Vda, size = range^2)) +
scale_radius(range = c(0, 0.05), guide = "none") +
scale_color_gradient2(low = "blue", high = "red") +
scale_y_continuous(limits = c(0, 100000)) +
coord_polar()
radial_wind2 <- ReadNetCDF("data/cfrad.20181111_105834.0000_to_20181111_110122.0000_RMA4_0200_02.nc", vars = c("VRAD", "azimuth", "elevation"))
one_elevation <- subset(radial_wind2, elevation == unique(elevation)[1] &
!is.na(Vda))
ggplot(one_elevation, aes(azimuth, range)) +
geom_point(aes(color = Vda, size = range^2)) +
scale_radius(range = c(0, 0.05), guide = "none") +
scale_color_gradient2(low = "blue", high = "red") +
scale_y_continuous(limits = c(0, 100000)) +
coord_polar()
one_elevation <- subset(radial_wind2, elevation == unique(elevation)[1] &
!is.na(VRAD))
ggplot(one_elevation, aes(azimuth, range)) +
geom_point(aes(color = VRAD, size = range^2)) +
scale_radius(range = c(0, 0.05), guide = "none") +
scale_color_gradient2(low = "blue", high = "red") +
scale_y_continuous(limits = c(0, 100000)) +
coord_polar()
radial_wind <- ReadNetCDF("data/cfrad.20181111_105834.0000_to_20181111_110122.0000_RMA4_0200_02.nc", vars = c("Vda", "azimuth", "elevation"))
one_elevation <- subset(radial_wind, elevation == unique(elevation)[1] &
!is.na(Vda))
ggplot(one_elevation, aes(azimuth, range)) +
geom_point(aes(color = Vda, size = range^2)) +
scale_radius(range = c(0, 0.05), guide = "none") +
scale_color_gradient2(low = "blue", high = "red") +
scale_y_continuous(limits = c(0, 100000)) +
coord_polar()
radial_wind <- ReadNetCDF("data/cfrad.20181101_120244.0000_to_20181101_120532.0000_RMA4_0200_02.nc", vars = c("Vda", "azimuth", "elevation"))
VAD <- with(radial_wind, vad_fit(Vda, azimuth, range, elevation))
plot(VAD)
VAD <- with(radial_wind, vad_fit(Vda, azimuth, range, elevation))
plot(VAD)
radial_wind <- ReadNetCDF("data/cfrad.20181101_120244.0000_to_20181101_120532.0000_RMA4_0200_02.nc", vars = c("Vda", "azimuth", "elevation"))
VAD <- with(radial_wind, vad_fit(Vda, azimuth, range, elevation))
View(VAD)
one_elevation <- subset(radial_wind, elevation == unique(elevation)[1] &
!is.na(Vda))
ggplot(one_elevation, aes(azimuth, range)) +
geom_point(aes(color = Vda, size = range^2)) +
scale_radius(range = c(0, 0.05), guide = "none") +
scale_color_gradient2(low = "blue", high = "red") +
scale_y_continuous(limits = c(0, 100000)) +
coord_polar()
radial_wind2 <- ReadNetCDF("data/cfrad.20181101_120244.0000_to_20181101_120532.0000_RMA4_0200_02.nc", vars = c("VRAD", "azimuth", "elevation"))
one_elevation <- subset(radial_wind, elevation == unique(elevation)[1] &
!is.na(VRAD))
ggplot(one_elevation, aes(azimuth, range)) +
geom_point(aes(color = VRAD, size = range^2)) +
scale_radius(range = c(0, 0.05), guide = "none") +
scale_color_gradient2(low = "blue", high = "red") +
scale_y_continuous(limits = c(0, 100000)) +
coord_polar()
one_elevation <- subset(radial_wind2, elevation == unique(elevation)[1] &
!is.na(VRAD))
ggplot(one_elevation, aes(azimuth, range)) +
geom_point(aes(color = VRAD, size = range^2)) +
scale_radius(range = c(0, 0.05), guide = "none") +
scale_color_gradient2(low = "blue", high = "red") +
scale_y_continuous(limits = c(0, 100000)) +
coord_polar()
one_elevation <- subset(radial_wind2, elevation == unique(elevation)[2] &
!is.na(VRAD))
ggplot(one_elevation, aes(azimuth, range)) +
geom_point(aes(color = VRAD, size = range^2)) +
scale_radius(range = c(0, 0.05), guide = "none") +
scale_color_gradient2(low = "blue", high = "red") +
scale_y_continuous(limits = c(0, 100000)) +
coord_polar()
one_elevation <- subset(radial_wind2, elevation == unique(elevation)[3] &
!is.na(VRAD))
ggplot(one_elevation, aes(azimuth, range)) +
geom_point(aes(color = VRAD, size = range^2)) +
scale_radius(range = c(0, 0.05), guide = "none") +
scale_color_gradient2(low = "blue", high = "red") +
scale_y_continuous(limits = c(0, 100000)) +
coord_polar()
one_elevation <- subset(radial_wind2, elevation == unique(elevation)[4] &
!is.na(VRAD))
ggplot(one_elevation, aes(azimuth, range)) +
geom_point(aes(color = VRAD, size = range^2)) +
scale_radius(range = c(0, 0.05), guide = "none") +
scale_color_gradient2(low = "blue", high = "red") +
scale_y_continuous(limits = c(0, 100000)) +
coord_polar()
radial_wind <- ReadNetCDF("data/cfrad.20181111_120018.0000_to_20181111_120300.0000_RMA4_0200_02.nc", vars = c("Vda", "azimuth", "elevation"))
VAD <- with(radial_wind, vad_fit(Vda, azimuth, range, elevation))
plot(VAD)
wind_profile <- vad_regrid(VAD, layer_width = 100)
plot(wind_profile)
radial_wind2 <- ReadNetCDF("data/cfrad.20181111_120018.0000_to_20181111_120300.0000_RMA4_0200_02.nc", vars = c("VRAD", "azimuth", "elevation"))
one_elevation <- subset(radial_wind2, elevation == unique(elevation)[1] &
!is.na(VRAD))
ggplot(one_elevation, aes(azimuth, range)) +
geom_point(aes(color = VRAD, size = range^2)) +
scale_radius(range = c(0, 0.05), guide = "none") +
scale_color_gradient2(low = "blue", high = "red") +
scale_y_continuous(limits = c(0, 100000)) +
coord_polar()
one_elevation <- subset(radial_wind, elevation == unique(elevation)[1] &
!is.na(Vda))
ggplot(one_elevation, aes(azimuth, range)) +
geom_point(aes(color = Vda, size = range^2)) +
scale_radius(range = c(0, 0.05), guide = "none") +
scale_color_gradient2(low = "blue", high = "red") +
scale_y_continuous(limits = c(0, 100000)) +
coord_polar()
ggplot(one_elevation, aes(azimuth, range)) +
geom_point(aes(color = Vda, size = range^2)) +
scale_radius(range = c(0, 0.05), guide = "none") +
scale_color_gradient2(low = "blue", high = "red", limits = c(-20, 20)) +
scale_y_continuous(limits = c(0, 100000)) +
coord_polar()
ggplot(one_elevation, aes(azimuth, range)) +
geom_point(aes(color = Vda, size = range^2)) +
scale_radius(range = c(0, 0.05), guide = "none") +
scale_color_gradient2(low = "blue", high = "red", limits = c(-25, 25)) +
scale_y_continuous(limits = c(0, 100000)) +
coord_polar()
raobs <- fread("data/sounding.csv")
View(raobs)
ggplot(raobs, aes(V6, V2)) +
geom_point()
raobs <- fread("data/sounding.csv", na.strings = "99999")
ggplot(raobs, aes(V6, V2)) +
geom_point()
ggplot(raobs, aes(V6, V2)) +
geom_point() +
scale_y_level()
ggplot(raobs, aes(V7, V2)) +
geom_point() +
scale_y_level()
ggplot(raobs, aes(V2, V7)) +
geom_point() +
scale_y_level() +
coord_flip()
ggplot(raobs, aes(V2, V7)) +
geom_point() +
scale_x_level() +
coord_flip()
ggplot(raobs, aes(V7, V2)) +
geom_point() +
geom_path() +
scale_y_level()
library(dplyr)
na.omit(raobs) %>%
ggplot(aes(V7, V2)) +
geom_point() +
geom_path() +
scale_y_level()
na.omit(raobs) %>%
ggplot(aes(V7, V2)) +
geom_point() +
geom_path() +
scale_y_level(limits = c(10000, 3000))
na.omit(raobs) %>%
ggplot(aes(V7, V2)) +
geom_point() +
geom_path() +
scale_y_level(limits = c(10000, 7000))
na.omit(raobs) %>%
ggplot(aes(V7/10, V2)) +
geom_point() +
geom_path() +
scale_y_level(limits = c(10000, 7000))
na.omit(raobs) %>%
ggplot(aes(V7/10, V3)) +
geom_point() +
geom_path()
na.omit(raobs) %>%
ggplot(aes(V7/10, V3)) +
geom_point() +
geom_path() +
scale_y_continuous(limits = c(0, 3000))
na.omit(raobs) %>%
ggplot(aes(V7/10, V3)) +
geom_point() +
geom_path() +
scale_y_continuous(limits = c(0, 5000))
View(wind_profile)
na.omit(raobs) %>%
ggplot(aes(V7/10, V3)) +
geom_point() +
geom_path() +
scale_y_continuous(limits = c(0, 5000)) +
geom_point(wind_profile, aes(sqrt(u^2+v^2), height), color = "blue")
na.omit(raobs) %>%
ggplot(aes(V7/10, V3)) +
geom_point() +
geom_path() +
scale_y_continuous(limits = c(0, 5000)) +
geom_point(data = wind_profile, aes(sqrt(u^2+v^2), height), color = "blue")
na.omit(raobs) %>%
ggplot(aes(V7/10, V3)) +
geom_point() +
geom_path() +
scale_y_continuous(limits = c(0, 5000)) +
geom_point(data = wind_profile, aes(sqrt(u^2+v^2), height-120), color = "blue")
na.omit(raobs) %>%
ggplot(aes(V7/10, V3)) +
geom_point() +
geom_path() +
scale_y_continuous(limits = c(0, 5000)) +
geom_point(data = wind_profile, aes(sqrt(u^2+v^2), height), color = "blue")
na.omit(raobs) %>%
ggplot(aes(V7/10, V3)) +
geom_point() +
geom_path() +
scale_y_continuous(limits = c(0, 5000)) +
geom_point(data = wind_profile, aes(sqrt(u^2+v^2), height+120), color = "blue")
plot(VAD)
na.omit(raobs) %>%
ggplot(aes(V7/10, V3)) +
geom_point() +
geom_path() +
scale_y_continuous(limits = c(0, 5000)) +
geom_point(data = VAD, aes(sqrt(u^2+v^2), height+120, color = elevation))
na.omit(raobs) %>%
ggplot(aes(V7/10, V3)) +
geom_point() +
geom_path() +
scale_y_continuous(limits = c(0, 5000)) +
geom_point(data = VAD, aes(sqrt(u^2+v^2), height+120, color = factor(elevation)))
na.omit(raobs) %>%
ggplot(aes(V7/10, V3)) +
geom_point() +
geom_path() +
scale_y_continuous(limits = c(0, 5000)) +
geom_point(data = VAD, aes(sqrt(u^2+v^2), height+120, color = factor(elevation)), na.rm = TRUE)
na.omit(raobs) %>%
ggplot(aes(V7/10, V3)) +
geom_point() +
geom_path() +
scale_y_continuous(limits = c(0, 5000)) +
geom_point(data = VAD, aes(sqrt(u^2+v^2), height+120, color = r2), na.rm = TRUE)
one_elevation <- subset(radial_wind, elevation == unique(elevation)[1] &
!is.na(Vda))
ggplot(one_elevation, aes(azimuth, range)) +
geom_point(aes(color = Vda, size = range^2)) +
scale_radius(range = c(0, 0.05), guide = "none") +
scale_color_gradient2(low = "blue", high = "red", limits = c(-25, 25)) +
scale_y_continuous(limits = c(0, 100000)) +
coord_polar()
ggplot(one_elevation, aes(azimuth, range)) +
stat_subset(aes(subset = is.cross(azimith, range), color = Vda, size = range^2)) +
# geom_point(aes(color = Vda, size = range^2)) +
scale_radius(range = c(0, 0.05), guide = "none") +
scale_color_gradient2(low = "blue", high = "red", limits = c(-25, 25)) +
scale_y_continuous(limits = c(0, 100000)) +
coord_polar()
ggplot(one_elevation, aes(azimuth, range)) +
stat_subset(aes(subset = is.cross(azimuth, range), color = Vda, size = range^2), geom = "point") +
# geom_point(aes(color = Vda, size = range^2)) +
scale_radius(range = c(0, 0.05), guide = "none") +
scale_color_gradient2(low = "blue", high = "red", limits = c(-25, 25)) +
scale_y_continuous(limits = c(0, 100000)) +
coord_polar()
radial_wind <- ReadNetCDF("data/cfrad.20181111_120018.0000_to_20181111_120300.0000_RMA4_0200_02.nc", vars = c("Vda", "azimuth", "elevation"))
radial_wind2 <- ReadNetCDF("data/cfrad.20181111_120018.0000_to_20181111_120300.0000_RMA4_0200_02.nc", vars = c("Vda2", "azimuth", "elevation"))
radial_wind3 <- ReadNetCDF("data/cfrad.20181111_120018.0000_to_20181111_120300.0000_RMA4_0200_02.nc", vars = c("Vda3", "azimuth", "elevation"))
radial_wind_ori <- ReadNetCDF("data/cfrad.20181111_120018.0000_to_20181111_120300.0000_RMA4_0200_02.nc", vars = c("VRAD", "azimuth", "elevation"))
one_elevation <- subset(radial_wind2, elevation == unique(elevation)[1] &
!is.na(Vda2))
ggplot(one_elevation, aes(azimuth, range)) +
stat_subset(aes(subset = is.cross(azimuth, range), color = Vda2, size = range^2), geom = "point") +
# geom_point(aes(color = Vda, size = range^2)) +
scale_radius(range = c(0, 0.05), guide = "none") +
scale_color_gradient2(low = "blue", high = "red", limits = c(-25, 25)) +
scale_y_continuous(limits = c(0, 100000)) +
coord_polar()
ggplot(one_elevation, aes(azimuth, range)) +
stat_subset(aes(subset = is.cross(azimuth, range), color = Vda2, size = range^2), geom = "point") +
# geom_point(aes(color = Vda, size = range^2)) +
scale_radius(range = c(0, 0.05), guide = "none") +
scale_color_gradient2(low = "blue", high = "red") +
scale_y_continuous(limits = c(0, 100000)) +
coord_polar()
one_elevation <- subset(radial_wind3, elevation == unique(elevation)[1] &
!is.na(Vda3))
ggplot(one_elevation, aes(azimuth, range)) +
stat_subset(aes(subset = is.cross(azimuth, range), color = Vda3, size = range^2), geom = "point") +
# geom_point(aes(color = Vda, size = range^2)) +
scale_radius(range = c(0, 0.05), guide = "none") +
scale_color_gradient2(low = "blue", high = "red") +
scale_y_continuous(limits = c(0, 100000)) +
coord_polar()
one_elevation <- subset(radial_wind, elevation == unique(elevation)[1] &
!is.na(Vda))
ggplot(one_elevation, aes(azimuth, range)) +
stat_subset(aes(subset = is.cross(azimuth, range), color = Vda, size = range^2), geom = "point") +
# geom_point(aes(color = Vda, size = range^2)) +
scale_radius(range = c(0, 0.05), guide = "none") +
scale_color_gradient2(low = "blue", high = "red") +
scale_y_continuous(limits = c(0, 100000)) +
coord_polar()
