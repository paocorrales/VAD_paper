ggplot(aes(V7/10, V3)) +
geom_point() +
geom_path()
na.omit(raobs) %>%
ggplot(aes(V7/10, V3)) +
geom_point() +
geom_path() +
scale_y_continuous(limits = c(0, 3000))
na.omit(raobs) %>%
ggplot(aes(V7/10, V3)) +
geom_point() +
geom_path() +
scale_y_continuous(limits = c(0, 5000))
View(wind_profile)
na.omit(raobs) %>%
ggplot(aes(V7/10, V3)) +
geom_point() +
geom_path() +
scale_y_continuous(limits = c(0, 5000)) +
geom_point(wind_profile, aes(sqrt(u^2+v^2), height), color = "blue")
na.omit(raobs) %>%
ggplot(aes(V7/10, V3)) +
geom_point() +
geom_path() +
scale_y_continuous(limits = c(0, 5000)) +
geom_point(data = wind_profile, aes(sqrt(u^2+v^2), height), color = "blue")
na.omit(raobs) %>%
ggplot(aes(V7/10, V3)) +
geom_point() +
geom_path() +
scale_y_continuous(limits = c(0, 5000)) +
geom_point(data = wind_profile, aes(sqrt(u^2+v^2), height-120), color = "blue")
na.omit(raobs) %>%
ggplot(aes(V7/10, V3)) +
geom_point() +
geom_path() +
scale_y_continuous(limits = c(0, 5000)) +
geom_point(data = wind_profile, aes(sqrt(u^2+v^2), height), color = "blue")
na.omit(raobs) %>%
ggplot(aes(V7/10, V3)) +
geom_point() +
geom_path() +
scale_y_continuous(limits = c(0, 5000)) +
geom_point(data = wind_profile, aes(sqrt(u^2+v^2), height+120), color = "blue")
plot(VAD)
na.omit(raobs) %>%
ggplot(aes(V7/10, V3)) +
geom_point() +
geom_path() +
scale_y_continuous(limits = c(0, 5000)) +
geom_point(data = VAD, aes(sqrt(u^2+v^2), height+120, color = elevation))
na.omit(raobs) %>%
ggplot(aes(V7/10, V3)) +
geom_point() +
geom_path() +
scale_y_continuous(limits = c(0, 5000)) +
geom_point(data = VAD, aes(sqrt(u^2+v^2), height+120, color = factor(elevation)))
na.omit(raobs) %>%
ggplot(aes(V7/10, V3)) +
geom_point() +
geom_path() +
scale_y_continuous(limits = c(0, 5000)) +
geom_point(data = VAD, aes(sqrt(u^2+v^2), height+120, color = factor(elevation)), na.rm = TRUE)
na.omit(raobs) %>%
ggplot(aes(V7/10, V3)) +
geom_point() +
geom_path() +
scale_y_continuous(limits = c(0, 5000)) +
geom_point(data = VAD, aes(sqrt(u^2+v^2), height+120, color = r2), na.rm = TRUE)
one_elevation <- subset(radial_wind, elevation == unique(elevation)[1] &
!is.na(Vda))
ggplot(one_elevation, aes(azimuth, range)) +
geom_point(aes(color = Vda, size = range^2)) +
scale_radius(range = c(0, 0.05), guide = "none") +
scale_color_gradient2(low = "blue", high = "red", limits = c(-25, 25)) +
scale_y_continuous(limits = c(0, 100000)) +
coord_polar()
ggplot(one_elevation, aes(azimuth, range)) +
stat_subset(aes(subset = is.cross(azimith, range), color = Vda, size = range^2)) +
# geom_point(aes(color = Vda, size = range^2)) +
scale_radius(range = c(0, 0.05), guide = "none") +
scale_color_gradient2(low = "blue", high = "red", limits = c(-25, 25)) +
scale_y_continuous(limits = c(0, 100000)) +
coord_polar()
ggplot(one_elevation, aes(azimuth, range)) +
stat_subset(aes(subset = is.cross(azimuth, range), color = Vda, size = range^2), geom = "point") +
# geom_point(aes(color = Vda, size = range^2)) +
scale_radius(range = c(0, 0.05), guide = "none") +
scale_color_gradient2(low = "blue", high = "red", limits = c(-25, 25)) +
scale_y_continuous(limits = c(0, 100000)) +
coord_polar()
radial_wind <- ReadNetCDF("data/cfrad.20181111_120018.0000_to_20181111_120300.0000_RMA4_0200_02.nc", vars = c("Vda", "azimuth", "elevation"))
radial_wind2 <- ReadNetCDF("data/cfrad.20181111_120018.0000_to_20181111_120300.0000_RMA4_0200_02.nc", vars = c("Vda2", "azimuth", "elevation"))
radial_wind3 <- ReadNetCDF("data/cfrad.20181111_120018.0000_to_20181111_120300.0000_RMA4_0200_02.nc", vars = c("Vda3", "azimuth", "elevation"))
radial_wind_ori <- ReadNetCDF("data/cfrad.20181111_120018.0000_to_20181111_120300.0000_RMA4_0200_02.nc", vars = c("VRAD", "azimuth", "elevation"))
one_elevation <- subset(radial_wind2, elevation == unique(elevation)[1] &
!is.na(Vda2))
ggplot(one_elevation, aes(azimuth, range)) +
stat_subset(aes(subset = is.cross(azimuth, range), color = Vda2, size = range^2), geom = "point") +
# geom_point(aes(color = Vda, size = range^2)) +
scale_radius(range = c(0, 0.05), guide = "none") +
scale_color_gradient2(low = "blue", high = "red", limits = c(-25, 25)) +
scale_y_continuous(limits = c(0, 100000)) +
coord_polar()
ggplot(one_elevation, aes(azimuth, range)) +
stat_subset(aes(subset = is.cross(azimuth, range), color = Vda2, size = range^2), geom = "point") +
# geom_point(aes(color = Vda, size = range^2)) +
scale_radius(range = c(0, 0.05), guide = "none") +
scale_color_gradient2(low = "blue", high = "red") +
scale_y_continuous(limits = c(0, 100000)) +
coord_polar()
one_elevation <- subset(radial_wind3, elevation == unique(elevation)[1] &
!is.na(Vda3))
ggplot(one_elevation, aes(azimuth, range)) +
stat_subset(aes(subset = is.cross(azimuth, range), color = Vda3, size = range^2), geom = "point") +
# geom_point(aes(color = Vda, size = range^2)) +
scale_radius(range = c(0, 0.05), guide = "none") +
scale_color_gradient2(low = "blue", high = "red") +
scale_y_continuous(limits = c(0, 100000)) +
coord_polar()
one_elevation <- subset(radial_wind, elevation == unique(elevation)[1] &
!is.na(Vda))
ggplot(one_elevation, aes(azimuth, range)) +
stat_subset(aes(subset = is.cross(azimuth, range), color = Vda, size = range^2), geom = "point") +
# geom_point(aes(color = Vda, size = range^2)) +
scale_radius(range = c(0, 0.05), guide = "none") +
scale_color_gradient2(low = "blue", high = "red") +
scale_y_continuous(limits = c(0, 100000)) +
coord_polar()
library(data.table)
library(dplyr)
raobs <- fread("data/raob_soundings26577.tmp")
readLines("data/raob_soundings26577.tmp")
lines <- raobs <- fread("data/sounding.csv", na.strings = "99999")
lines <- readLines("data/raob_soundings26577.tmp")
lines[1]
strsplit(lines[1], " ")
strsplit(lines, " ")
temp <- strsplit(lines, " ")
temp <- lapply(temp, function(x) x[x != ""])
temp
lapply(temp, funtion(x) x[1] == "254")
lapply(temp, function(x) x[1] == "254")
vapply(temp, function(x) x[1] == "254", TRUE)
vapply(temp, function(x) x[1] == "254", 1)
vapply(temp, function(x) x[1] == "254", "a")
vapply(temp, function(x) x[1] == "254", TRUE)
which(vapply(temp, function(x) x[1] == "254", TRUE))
idx <- which(vapply(temp, function(x) x[1] == "254", TRUE))
i = 1
temp[(idx[i] + 4):(idx[i + 1] - 1)]
as.data.table(temp[(idx[i] + 4):(idx[i + 1] - 1)])
transpose(as.data.table(temp[(idx[i] + 4):(idx[i + 1] - 1)]))
out <- transpose(as.data.table(temp[(idx[i] + 4):(idx[i + 1] - 1)]))
colnames(out) <- c("pressure", "height", "temp", "dewpt", "winddir", "windspd")
colnames(out) <- c("type", "pressure", "height", "temp", "dewpt", "winddir", "windspd")
temp[(idx[i])]
f <- temp[(idx[i])]
f <- temp[[(idx[i])]]
f[1]
paste0(f[5], f[4], f[3], sep = "-")
paste(f[5], f[4], f[3], sep = "-")
library(libridate)
library(lubridate)
ymd(paste(f[5], f[4], f[3], sep = "-"))
ymd_h(paste(paste(f[5], f[4], f[3], sep = "-"), f[2], sep = " "))
paste(paste(f[5], f[4], f[3], sep = "-"), f[2], sep = " ")
ymd_h(paste(paste(f[5], f[4], f[3], sep = "-"), f[2], sep = "_"))
ymd_h(paste(paste(f[5], f[4], f[3], f[2], sep = "-"))
ymd_h(paste(f[5], f[4], f[3], f[2], sep = "-"))
ymd_h(paste(paste(f[5], f[4], f[3], sep = "-"), f[2], sep = " "))
ymd_hm(paste(paste(f[5], f[4], f[3], sep = "-"), f[2], ":00", sep = " "))
soundings <- list()
for (i in seq_along(idx)) {
out <- transpose(as.data.table(temp[(idx[i] + 4):(idx[i + 1] - 1)]))
colnames(out) <- c("type", "pressure", "height", "temp", "dewpt", "winddir", "windspd")
f <- temp[(idx[i])]
out[, time := ymd_hm(paste(paste(f[5], f[4], f[3], sep = "-"), f[2], ":00", sep = " "))]
soundings[[i]] <- out
}
idx <- c(idx, length(temp))
soundings <- list()
for (i in seq_along(idx)) {
out <- transpose(as.data.table(temp[(idx[i] + 4):(idx[i + 1] - 1)]))
colnames(out) <- c("type", "pressure", "height", "temp", "dewpt", "winddir", "windspd")
f <- temp[(idx[i])]
out[, time := ymd_hm(paste(paste(f[5], f[4], f[3], sep = "-"), f[2], ":00", sep = " "))]
soundings[[i]] <- out
}
idx
# Indices donde comienza cada sondeo
idx <- which(vapply(temp, function(x) x[1] == "254", TRUE))
idx <- c(idx, length(temp)+1)
4idx
odx
idx
soundings <- list()
for (i in seq_along(idx)) {
out <- transpose(as.data.table(temp[(idx[i] + 4):(idx[i + 1] - 1)]))
colnames(out) <- c("type", "pressure", "height", "temp", "dewpt", "winddir", "windspd")
f <- temp[(idx[i])]
out[, time := ymd_hm(paste(paste(f[5], f[4], f[3], sep = "-"), f[2], ":00", sep = " "))]
soundings[[i]] <- out
}
i
soundings <- list()
for (i in seq_len(length(idx)-1) {
soundings <- list()
for (i in seq_len(length(idx)-1)) {
out <- transpose(as.data.table(temp[(idx[i] + 4):(idx[i + 1] - 1)]))
colnames(out) <- c("type", "pressure", "height", "temp", "dewpt", "winddir", "windspd")
f <- temp[(idx[i])]
out[, time := ymd_hm(paste(paste(f[5], f[4], f[3], sep = "-"), f[2], ":00", sep = " "))]
soundings[[i]] <- out
}
soundings <- rbindlist(soundings)
View(soundings)
warnings()
soundings <- list()
for (i in seq_len(length(idx)-1)) {
out <- transpose(as.data.table(temp[(idx[i] + 4):(idx[i + 1] - 1)]))
colnames(out) <- c("type", "pressure", "height", "temp", "dewpt", "winddir", "windspd")
browser()
out[, time := ymd_hm(paste(paste(f[5], f[4], f[3], sep = "-"), f[2], ":00", sep = " "))]
soundings[[i]] <- out
}
q
exit
exit()
quit()
i = 1
out <- transpose(as.data.table(temp[(idx[i] + 4):(idx[i + 1] - 1)]))
colnames(out) <- c("type", "pressure", "height", "temp", "dewpt", "winddir", "windspd")
View(out)
f <- temp[(idx[i])]
f[1]
f[5]
f[[1]]
f[[2]]
f[[1]][1]
as.vector(f)
f <- as.vector(f)
f
f <- temp[(idx[i])]
out[, time := ymd_hm(paste(paste(f[[1]][5], f[[1]][4], f[[1]][3], sep = "-"), f[[1]][2], ":00", sep = " "))]
View(out)
idx <- which(vapply(temp, function(x) x[1] == "254", TRUE))
idx <- c(idx, length(temp)+1)
soundings <- list()
for (i in seq_len(length(idx)-1)) {
out <- transpose(as.data.table(temp[(idx[i] + 4):(idx[i + 1] - 1)]))
colnames(out) <- c("type", "pressure", "height", "temp", "dewpt", "winddir", "windspd")
f <- temp[(idx[i])]
out[, time := ymd_hm(paste(paste(f[[1]][5], f[[1]][4], f[[1]][3], sep = "-"), f[[1]][2], ":00", sep = " "))]
soundings[[i]] <- out
}
soundings <- rbindlist(soundings)
View(soundings)
str(soundings)
i =1
out <- transpose(as.data.table(as.numeric(temp[(idx[i] + 4):(idx[i + 1] - 1)])))
(temp[(idx[i] + 4):(idx[i + 1] - 1)])
transpose(temp[(idx[i] + 4):(idx[i + 1] - 1)]))
transpose(temp[(idx[i] + 4):(idx[i + 1] - 1)])
as.data.table(transpose(temp[(idx[i] + 4):(idx[i + 1] - 1)]))
out[, names(out) := lapply(.SD, as.numeric)]
colnames(out) <- c("type", "pressure", "height", "temp", "dewpt", "winddir", "windspd")
i =1
out <- transpose(as.data.table((temp[(idx[i] + 4):(idx[i + 1] - 1)])))
out[, names(out) := lapply(.SD, as.numeric)]
colnames(out) <- c("type", "pressure", "height", "temp", "dewpt", "winddir", "windspd")
out[, lapply(.SD, function(x) {
x[x == 99999] <- NA
x
}
)
f <- temp[(idx[i])]
out[, time := ymd_hm(paste(paste(f[[1]][5], f[[1]][4], f[[1]][3], sep = "-"), f[[1]][2], ":00", sep = " "))]
soundings[[i]] <- out
}
soundings <- rbindlist(soundings)
out[, lapply(.SD, function(x) {
x[x == 99999] <- NA
x
}
)]
soundings <- list()
for (i in seq_len(length(idx)-1)) {
out <- transpose(as.data.table((temp[(idx[i] + 4):(idx[i + 1] - 1)])))
out[, names(out) := lapply(.SD, as.numeric)]
colnames(out) <- c("type", "pressure", "height", "temp", "dewpt", "winddir", "windspd")
out <- out[, lapply(.SD, function(x) {
x[x == 99999] <- NA
x
}
)]
f <- temp[(idx[i])]
out[, time := ymd_hm(paste(paste(f[[1]][5], f[[1]][4], f[[1]][3], sep = "-"), f[[1]][2], ":00", sep = " "))]
soundings[[i]] <- out
}
soundings <- rbindlist(soundings)
View(soundings)
fwrite(soundings, "data/soundings_87155.csv")
library(data.table)
library(rvad)
library(metR)
library(ggplot2)
files <- system.file("/mnt/Data/VAD/RMA4/cfrad.20181*_120*")
files <- system.file("/mnt/Data/VAD/RMA4/cfrad.20181*_120*.nc")
files <- Sys.glob("/mnt/Data/VAD/RMA4/cfrad.20181*_120*.nc")
files
seq_along(files)
basename(files[1])
basename(files[1])[7:15]
name <- basename(files[1])
name[7:15]
substr(basename(files[1]), 7, 15)
substr(basename(files[1]), 7, 14)
for (i in seq_along(files)) {
radial_wind <- ReadNetCDF(files[i], vars = c("Vda", "azimuth", "elevation"))
VAD <- with(radial_wind, vad_fit(Vda, azimuth, range, elevation))
plot(VAD)
ggsave(paste0("/mnt/Data/VAD/RMA4/fig/vad_", substr(basename(files[1]), 7, 14), ".png"))
}
for (i in seq_along(files)) {
radial_wind <- ReadNetCDF(files[i], vars = c("Vda", "azimuth", "elevation"))
VAD <- with(radial_wind, vad_fit(Vda, azimuth, range, elevation))
plot(VAD)
ggsave(paste0("/mnt/Data/VAD/RMA4/fig/vad_", substr(basename(files[i]), 7, 14), ".png"))
}
substr(basename(files[i]), 7, 21)
for (i in seq_along(files)) {
# Leo el volumen y calculo el VAD
radial_wind <- ReadNetCDF(files[i], vars = c("Vda", "azimuth", "elevation"))
VAD <- with(radial_wind, vad_fit(Vda, azimuth, range, elevation))
plot(VAD)
# Leo el sondeo
ggsave(paste0("/mnt/Data/VAD/RMA4/fig/vad_", substr(basename(files[i]), 7, 21), ".png"))
}
soundings <- fread("data/soundings_87155.csv")
soundings[, time := as_datetime(time)]
View(soundings)
i =1
date_time <- ymd_h(substr(basename(files[i]), 7, 14))
substr(basename(files[i]), 7, 14)
date_time <- ymd(substr(basename(files[i]), 7, 14))
date_time
date_time <- ymd_hm(paste0(substr(basename(files[i]), 7, 14), " 12:00"))
date_time
soundings[, time == date_time]
soundings[time == date_time]
soundings[time == date_time] %>%
ggplot(aes(windspd, height)) +
geom_path()
soundings[time == date_time] %>%
ggplot(aes(windspd/10, height)) +
geom_path()
soundings[time == date_time] %>%
na.omit() %>%
ggplot(aes(windspd/10, height)) +
geom_path()
soundings[time == date_time] %>%
na.omit() %>%
ggplot(aes(windspd/10, height)) +
geom_path() +
coord_cartesian(ylim = c(0, 3000))
soundings[time == date_time] %>%
na.omit() %>%
ggplot(aes(windspd/10, height)) +
geom_path() +
coord_cartesian(ylim = c(0, 3000), xlim = c(0, 25))
soundings[time == date_time] %>%
na.omit() %>%
ggplot(aes(windspd/10, height)) +
geom_path() +
geom_point(data = VAD, aes(sqrt(u^2 + v^2), height), color = elevation) +
coord_cartesian(ylim = c(0, 3000), xlim = c(0, 25))
soundings[time == date_time] %>%
na.omit() %>%
ggplot(aes(windspd/10, height)) +
geom_path() +
geom_point(data = VAD, aes(sqrt(u^2 + v^2), height, color = elevation)) +
coord_cartesian(ylim = c(0, 3000), xlim = c(0, 25))
soundings[time == date_time] %>%
na.omit() %>%
ggplot(aes(windspd/10, height)) +
geom_path() +
geom_point(data = VAD, aes(sqrt(u^2 + v^2), height, color = factor(elevation))) +
coord_cartesian(ylim = c(0, 3000), xlim = c(0, 25))
soundings[time == date_time] %>%
na.omit() %>%
ggplot(aes(windspd/10, height)) +
geom_path() +
geom_point(data = VAD, aes(sqrt(u^2 + v^2), height + 119, color = factor(elevation))) +
coord_cartesian(ylim = c(0, 3000), xlim = c(0, 25))
soundings[time == date_time] %>%
na.omit() %>%
ggplot(aes(windspd/10, height)) +
geom_path() +
geom_point(data = VAD, aes(sqrt(u^2 + v^2), height + 119, color = factor(elevation))) +
coord_cartesian(ylim = c(0, 2000), xlim = c(0, 25))
files <- Sys.glob("/mnt/Data/VAD/RMA4/cfrad.20181*_120*.nc")
soundings <- fread("data/soundings_87155.csv")
soundings[, time := as_datetime(time)]
for (i in seq_along(files)) {
# Leo el volumen y calculo el VAD
radial_wind <- ReadNetCDF(files[i], vars = c("Vda", "azimuth", "elevation"))
VAD <- with(radial_wind, vad_fit(Vda, azimuth, range, elevation))
plot(VAD)
# Leo el sondeo
date_time <- ymd_hm(paste0(substr(basename(files[i]), 7, 14), " 12:00"))
soundings[time == date_time] %>%
na.omit() %>%
ggplot(aes(windspd/10, height)) +
geom_path() +
geom_point(data = VAD, aes(sqrt(u^2 + v^2), height + 119, color = factor(elevation))) +
coord_cartesian(ylim = c(0, 2000), xlim = c(0, 25))
ggsave(paste0("/mnt/Data/VAD/RMA4/fig/vad_", substr(basename(files[i]), 7, 21), ".png"))
}
knitr::opts_chunk$set(echo = TRUE)
path <- "/mnt/Data/VAD/RMA4/cfrad.20181121_120124.0000_to_20181121_120412.0000_RMA4_0200_02.nc"
radial_wind <- ReadNetCDF(path, vars = c("Vda", "azimuth", "elevation"))
radial_wind <- ReadNetCDF(path, vars = c("Vda", "azimuth", "elevation"))
VAD <- with(radial_wind, vad_fit(Vda, azimuth, range, elevation))
library(rvad)
library(ggplot2)
library(data.table)
library(metR)
library(dplyr)
library(rvad)
library(ggplot2)
library(data.table)
library(metR)
library(dplyr)
path <- "/mnt/Data/VAD/RMA4/cfrad.20181121_120124.0000_to_20181121_120412.0000_RMA4_0200_02.nc"
radial_wind <- ReadNetCDF(path, vars = c("Vda", "azimuth", "elevation"))
radial_wind <- ReadNetCDF(path, vars = c("Vda", "azimuth", "elevation"))
VAD <- with(radial_wind, vad_fit(Vda, azimuth, range, elevation))
VAD %>%
ggplot(aes(sqrt(u^2 + v^2), range)) +
geom_point()
VAD %>%
ggplot(aes(range, sqrt(u^2 + v^2))) +
geom_point()
VAD %>%
ggplot(aes(sqrt(u^2 + v^2), range)) +
geom_point()
VAD %>%
ggplot(aes(sqrt(u^2 + v^2), range)) +
geom_point(aes(color = elevation))
VAD %>%
ggplot(aes(sqrt(u^2 + v^2), range)) +
geom_point(aes(color = factor(elevation)))
range(VAD$height)
range(VAD$height, na.rm = TRUE)
cut_width(VAD$height, 100)
str(VAD)
setDT(VAD)
VAD[, spd := sqrt(u^2 + v^2)]
VAD[, a = FitLm(spd, range), by = cut_width(height, 100)]
na.omit(VAD) %>%
.[, a = FitLm(spd, range), by = cut_width(height, 100)]
na.omit(VAD) %>%
.[, FitLm(spd, range), by = cut_width(height, 100)]
na.omit(VAD) %>%
.[, FitLm(spd, range), by = cut_width(height, 100)] %>%
.[term == "range"]
na.omit(VAD) %>%
.[, .SD, by = cut_width(height, 100)]
na.omit(VAD) %>%
.[, FitLm(spd, range), by = cut_width(height, 100)] %>%
.[term == "range"] %>%
ggplot(aes(term, cut_with)) +
geom_point()
na.omit(VAD) %>%
.[, FitLm(spd, range), by = cut_width(height, 100)] %>%
.[term == "range"] %>%
ggplot(aes(term, cut_width)) +
geom_point()
na.omit(VAD) %>%
.[, FitLm(spd, range), by = cut_width(height, 100)] %>%
.[term == "range"]
na.omit(VAD) %>%
.[, FitLm(spd, range), by = cut_width(height, 100)] %>%
.[term == "range"] %>%
ggplot(aes(term, cut_width)) +
geom_point()
na.omit(VAD) %>%
.[, FitLm(spd, range), by = cut_width(height, 100)] %>%
.[term == "range"] %>%
ggplot(aes(estimate, cut_width)) +
geom_point()
na.omit(VAD) %>%
.[, FitLm(spd, range, se = TRUE), by = cut_width(height, 100)] %>%
.[term == "range"]
na.omit(VAD) %>%
.[, FitLm(spd, range, se = TRUE), by = cut_width(height, 100)] %>%
.[term == "range"] %>%
ggplot(aes(estimate, cut_width)) +
geom_point(aes(color = std.error))
na.omit(VAD) %>%
.[, FitLm(spd, range, se = TRUE), by = cut_width(height, 100)] %>%
.[term == "range"] %>%
ggplot(aes(estimate, cut_width)) +
geom_point(aes(color = std.error)) +
geom_errorbarh(aes(xmin = estimate - std.error*2, xmax = estimate + std.error*2))
na.omit(VAD) %>%
.[, FitLm(spd, range, se = TRUE), by = cut_width(height, 100)] %>%
.[term == "range"] %>%
ggplot(aes(estimate, cut_width)) +
geom_point(aes(color = df)) +
geom_errorbarh(aes(xmin = estimate - std.error*2, xmax = estimate + std.error*2))
